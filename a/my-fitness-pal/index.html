<html>
<head>
  <title>My Fitness Pal</title>
  <meta name="viewport" content="width=device-width, user-scalable=no">
  <style type="text/css">
    body {
      font-family: 'DIN Next LT Pro';
    }
    h3.mfp-title {
      font-size: 1.8em;
      padding-left: 0.8em;
      margin-bottom: 0.4em;
      text-transform:capitalize;
      font-weight:700;
    }
    h4.mfp-title {
      font-size: 1.5em;
      padding-left: 1em;
      margin-bottom: 0.4em;
      text-transform:capitalize;
      font-weight:700;
    }
    .os, .meal {
      margin-left: 1em;
    }
    hr {
      background-color: #ececec;
      height: 1px;
      border: 0;
    }
    span.no-capitalize {
      text-transform: none;
    }
    table.mfp {
      font-size: 1em;
      font-family: 'DIN Next LT Pro';
      font-weight: light;
      display: inline;
      margin-left: 0.8em;
    }
    table.mfp td {
      max-width: 350px;
      border-bottom: 1px dashed #ececec;
      padding-right: 0.15em;
    }
    table.mfp th {
      text-align: left;
      font-weight: 600;
    }
    table.mfp tr td:first-child {
      font-weight: lighter;
      font-size: 0.8em;
      padding-right: 5px;
      max-width: 25px;
      text-align: right;
    }
    table.mfp td.source {
      margin: 2em 0 2em 2em;
      color: #414141;
      font-style: italic;
      font-size: 0.7em;
      padding-top: 1.5em;
      border: 0;
    }
    .button_filter {
      font-family: ff-din-web-condensed, Helvetica, sans-serif;
      font-weight: 400;
      font-size: 0.9em;
      color: #FFFFFF;
      background-color: #000000;
      /*text-transform: uppercase;*/
      line-height: 1;
      display: inline-block;
      cursor: pointer;
      width: 20%;
      margin: 5px;
      padding: 0.5em;
      border: 0;
      }
    .button_filter:hover {
      background-color: #fb4834 !important;
    }
    .button_filter.selected {
      background-color: #fb4834 !important;
    }

  </style>
</head>
<body style="max-width: 565px;">
  <h3 class='mfp-title'>Top 20 foods entered into MyFitnessPal by operating system and meal</h3>
  <div class="filters">
    <div class="os" style="overflow:hidden;">
      <button class="button_filter os_filter" val="all">All</button>
      <button class="button_filter os_filter" val="ios">iOS</button>
      <button class="button_filter os_filter" val="android">Android</button>
      <button class="button_filter os_filter" val="windows">Windows</button>
    </div>
    <hr style="width: 100%;">
    <div class="meal">
      <button class="button_filter meal_filter" val="breakfast">Breakfast</button>
      <button class="button_filter meal_filter" val="lunch">Lunch</button>
      <button class="button_filter meal_filter" val="dinner">Dinner</button>
      <button class="button_filter meal_filter" val="snack">Snack</button>
    </div>
  </div>
  <div class="container"></div>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="data.js"></script>
  <script type="text/javascript">
    var types = ['Breakfast', 'Lunch', 'Dinner', 'Snacks'];

    function makeDiv(type) {
      $('.container').append('<div class="' + type + '"><h4 class="mfp-title">' + type + '</h4></div>');
    }

    function buildTable(type, arr, arrname) {
      console.log(arrname);
      if (arrname == "ios") {
        arrname = "iOS";
        $('.' + type + " h4").append("<span class='no-capitalize'> &mdash; " + arrname + "</span>");
      } else {
        $('.' + type + " h4").append(" &mdash; " + arrname + "</span>");
      }
      $('.' + type).append('<table style="display:none;" class="mfp ' + arrname + '"></table>');
      var target_div = $('.' + type + ' > .' + arrname)
      for (var i = 0; i < 20; i++) {
        target_div.append('<tr><td>' + arr[i][0] + '</td><td>' + arr[i][1] + '</td></tr>');
      }
      target_div.append("<tr><td></td><td class='source'>Data source: MyFitnessPal from 2005-2014</td></tr>");
      target_div.fadeIn();  
    }

    function checkFilters(){
      if (meal != undefined && os != undefined) {
        $('.container').empty();
        data_source = os + "_" + meal
        makeDiv(meal);
        buildTable(meal, window[data_source], os); 
      }
    }

    function filter(){
      buttonType = $(this).attr('class').split(" ")[1];
      type = buttonType.split(" ")[0].split("_")[0];
      $('.' + buttonType).removeClass('selected');
      if ($(this).hasClass('selected')) {
        $(this).removeClass('selected');
         window[type] = undefined;
      } else {
        $(this).addClass('selected');
        window[type] = $(this).attr('val');
        checkFilters(); 
    }
    }

    var meal = 'breakfast';
    var os = 'all';
    $(document).ready(function() {
      checkFilters();
      $("[val=all]").addClass('selected');
      $("[val=breakfast]").addClass('selected');

      $('.os_filter').on('click', filter);
      $('.meal_filter').on('click', filter);

    });

  </script>
</body>
</html>